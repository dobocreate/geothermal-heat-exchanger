# 地中熱交換システム計算ツール

地中熱交換システムの性能計算と最適化を行うStreamlitアプリケーションです。

## 概要

このツールは、地中熱交換システムにおける循環水の温度変化を計算し、最適な配管径や材質を提案します。NTU法に基づく詳細な熱交換計算により、実用的な設計支援を行います。

### 主な機能

- **熱交換計算**
  - NTU法による熱交換効率の計算
  - Reynolds数、Nusselt数の自動計算（層流/乱流判定）
  - 温度依存の水物性値を考慮
  
- **地下水温度上昇の評価**
  - 1回通水での自動計算
  - 循環運転時の累積効果
  - 温度上昇上限値の設定（5-20℃）

- **配管最適化**
  - 8種類の配管径（15A〜80A）の比較
  - 3種類の材質（鋼管、アルミ管、銅管）の評価
  - 並列配管セット本数の最適化

- **視覚化とレポート**
  - リアルタイムの計算結果表示
  - 配管性能の比較グラフ
  - 最適化提案の自動生成

## 必要条件

- Python 3.8以上
- pip (Pythonパッケージマネージャー)

## インストール

1. リポジトリをクローン
```bash
git clone https://github.com/dobocreate/geothermal-heat-exchanger.git
cd geothermal-heat-exchanger
```

2. 仮想環境の作成（推奨）
```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

3. 依存パッケージのインストール
```bash
pip install -r requirements.txt
```

## 使用方法

1. アプリケーションの起動
```bash
streamlit run app.py
```

2. ブラウザが自動的に開き、アプリケーションが表示されます

3. **計算ツール**タブで：
   - サイドバーで計算条件を入力
   - 単一配管計算または複数配管比較を選択
   - リアルタイムで計算結果を確認

4. **理論解説**タブで：
   - 計算理論の詳細を確認
   - 数式と前提条件を理解

5. **物性値データ**タブで：
   - 水の温度依存物性値を参照
   - 配管仕様（JIS規格）を確認

## 計算条件の設定

### 基本条件
- **初期温度**：20.0〜40.0℃
- **地下水温度**：10.0〜20.0℃
- **総流量**：20.0〜100.0 L/min
- **管浸水距離**：3.0〜15.0 m
- **掘削径**：φ116またはφ250

### 配管条件
- **配管材質**：鋼管、アルミ管、銅管
- **管径**：15A〜80A（JIS規格）
- **配管セット本数**：1〜5セット

### 地下水温度設定
- **温度上昇の考慮**：チェックボックスで選択
- **循環の考慮**：地下水が滞留する場合
- **運転時間**：1〜60分（循環時）
- **温度上昇上限**：5〜20℃

## 計算理論

### 熱交換の基本式
- 熱交換量：Q = ṁ × Cp × ΔT
- 効率：ε = 1 - exp(-NTU)
- NTU = UA / (ṁCp)

### 流体力学
- Reynolds数：Re = vD/ν
- Nusselt数（乱流）：Nu = 0.023 × Re^0.8 × Pr^0.3

### 地下水温度上昇
- ΔT_gw = Q × t / (m_gw × Cp)
- 地下水体積 = ボーリング孔体積 - 配管総体積

詳細は[heat_exchange_summary.md](heat_exchange_summary.md)を参照してください。

## プロジェクト構造

```
geothermal_heat_ex-changer/
├── app.py                    # Streamlitメインアプリケーション
├── requirements.txt          # 依存パッケージ
├── README.md                 # このファイル
├── CLAUDE.md                # Claude用ドキュメント
├── heat_exchange_summary.md  # 詳細な計算理論
└── .claude/
    └── settings.local.json   # Claude設定ファイル
```

## 更新履歴

- **v1.2.0** (2025-01-06)
  - 地下水温度上昇の自動計算機能
  - 1回通水時間での評価
  - 循環運転モード
  - 物性値データページ

- **v1.1.0**
  - NTU法による詳細計算
  - 温度依存物性値
  - 複数配管比較機能

- **v1.0.0**
  - 初期リリース

## ライセンス

MIT License

## 貢献

プルリクエストを歓迎します。大きな変更の場合は、まずissueを作成して変更内容を議論してください。

## 作者

dobocreate

## 参考文献

- 日本機械学会「伝熱工学資料」
- JIS G 3452 配管用炭素鋼鋼管
- 地中熱利用促進協会「地中熱利用システム設計・施工マニュアル」